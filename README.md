# æ¼«ç”»é˜…è¯»å™¨ Flutter

ä¸€ä¸ªç°ä»£åŒ–çš„è·¨å¹³å°æ¼«ç”»é˜…è¯»åº”ç”¨ï¼Œä½¿ç”¨ Flutter æ„å»ºï¼Œæ”¯æŒå¤šç§ç½‘ç»œåè®®ã€éšç§ä¿æŠ¤å’Œå¤šè®¾å¤‡åŒæ­¥åŠŸèƒ½ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ“š æ¼«ç”»åº“ç®¡ç†
- **å¤šåº“æ”¯æŒ**: åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤å¤šä¸ªæ¼«ç”»åº“ï¼Œæ”¯æŒæœ¬åœ°å’Œç½‘ç»œè·¯å¾„
- **æ™ºèƒ½æ‰«æ**: è‡ªåŠ¨æ‰«ææ¼«ç”»åº“ï¼Œè¯†åˆ«å›¾ç‰‡æ–‡ä»¶å¤¹å’Œå‹ç¼©åŒ…ä½œä¸ºæ¼«ç”»
- **å°é¢æ¨¡å¼**: æ”¯æŒé»˜è®¤ã€å·¦åŠã€å³åŠä¸‰ç§å°é¢å±•ç¤ºæ¨¡å¼
- **éšç§ä¿æŠ¤**: æ¼«ç”»åº“éšç§æ¨¡å¼ï¼Œæ”¯æŒå¯†ç å’Œç”Ÿç‰©è¯†åˆ«éªŒè¯
- **å®æ—¶åŒæ­¥**: æ”¯æŒå±€åŸŸç½‘å†…å¤šè®¾å¤‡æ¼«ç”»åº“åŒæ­¥

### ğŸŒ ç½‘ç»œåè®®æ”¯æŒ
- **HTTP/HTTPS**: æ ‡å‡†ç½‘é¡µåè®®æ”¯æŒ
- **SMB/CIFS**: Windows ç½‘ç»œå…±äº«åè®®
- **FTP/SFTP**: æ–‡ä»¶ä¼ è¾“åè®®
- **WebDAV**: ç½‘ç»œåˆ†å¸ƒå¼åˆ›ä½œå’Œç‰ˆæœ¬æ§åˆ¶åè®®
- **NFS**: ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿåè®®
- **è¿œç¨‹ç¼“å­˜**: ç½‘ç»œæ¼«ç”»æœ¬åœ°ç¼“å­˜ï¼Œæ”¯æŒç¦»çº¿é˜…è¯»

### ğŸ“– é˜…è¯»ä½“éªŒ
- **å¤šç§é˜…è¯»æ¨¡å¼**: å•é¡µã€åŒé¡µé˜…è¯»æ¨¡å¼
- **å…¨å±é˜…è¯»**: æ²‰æµ¸å¼é˜…è¯»ä½“éªŒ
- **è¿›åº¦è®°å¿†**: è‡ªåŠ¨ä¿å­˜é˜…è¯»è¿›åº¦ï¼Œæ”¯æŒè·¨è®¾å¤‡åŒæ­¥
- **é¢„åŠ è½½ä¼˜åŒ–**: æ™ºèƒ½é¢„åŠ è½½ï¼Œå‡å°‘é˜…è¯»å¡é¡¿
- **å¤šç§ç¿»é¡µæ–¹å¼**: é”®ç›˜ã€é¼ æ ‡ã€è§¦æ‘¸æ¿æ”¯æŒ
- **åº•éƒ¨è¿›åº¦æ¡**: å¸¦é¢„è§ˆçš„è¿›åº¦æ§åˆ¶

### ğŸ”’ éšç§ä¸å®‰å…¨
- **éšç§æ¨¡å¼**: æ¼«ç”»åº“çº§åˆ«çš„éšç§ä¿æŠ¤
- **å¤šé‡è®¤è¯**: å¯†ç  + ç”Ÿç‰©è¯†åˆ«ï¼ˆæŒ‡çº¹/é¢éƒ¨è¯†åˆ«ï¼‰
- **åº”ç”¨ä¿æŠ¤**: åº”ç”¨è¿›å…¥åå°æ—¶è‡ªåŠ¨æ¨¡ç³Šå±å¹•
- **æ¿€æ´»ç®¡ç†**: éšç§åº“æ¿€æ´»çŠ¶æ€ç®¡ç†ï¼Œé‡å¯åº”ç”¨éœ€é‡æ–°éªŒè¯

### ğŸ”„ å¤šè®¾å¤‡å…±äº«
- **è®¾å¤‡å‘ç°**: å±€åŸŸç½‘å†…è‡ªåŠ¨å‘ç°å…¶ä»–è®¾å¤‡
- **æ¼«ç”»åº“åŒæ­¥**: æ”¯æŒæ•´åº“æˆ–éƒ¨åˆ†åŒæ­¥
- **è¿›åº¦åŒæ­¥**: é˜…è¯»è¿›åº¦è·¨è®¾å¤‡åŒæ­¥
- **mDNS + UDP**: åŒé‡è®¾å¤‡å‘ç°æœºåˆ¶

### ğŸ¨ ç”¨æˆ·ç•Œé¢
- **ç°ä»£åŒ–è®¾è®¡**: Material Design 3 è®¾è®¡è¯­è¨€
- **å“åº”å¼å¸ƒå±€**: é€‚é…æ‰‹æœºã€å¹³æ¿ã€æ¡Œé¢ç«¯
- **ä¸»é¢˜åˆ‡æ¢**: æ·±è‰²/æµ…è‰²ä¸»é¢˜æ”¯æŒ
- **å¤šè¯­è¨€**: ä¸­æ–‡ã€è‹±æ–‡ã€æ—¥æ–‡ç­‰å¤šè¯­è¨€æ”¯æŒ

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæ¡†æ¶
- **Flutter**: 3.10.0+ è·¨å¹³å°UIæ¡†æ¶
- **Dart**: 3.0.0+ ç¼–ç¨‹è¯­è¨€
- **Riverpod**: ç°ä»£åŒ–çŠ¶æ€ç®¡ç†
- **Go Router**: å£°æ˜å¼è·¯ç”±ç®¡ç†

### æ•°æ®å­˜å‚¨
- **Drift**: è·¨å¹³å°SQLiteæ•°æ®åº“
- **SharedPreferences**: é…ç½®å­˜å‚¨
- **Path Provider**: æ–‡ä»¶è·¯å¾„ç®¡ç†
- **Crypto**: å¯†ç åŠ å¯†

### ç½‘ç»œä¸æ–‡ä»¶
- **Dio**: HTTPå®¢æˆ·ç«¯
- **Multicast DNS**: è®¾å¤‡å‘ç°
- **Archive**: å‹ç¼©æ–‡ä»¶å¤„ç†
- **PDFx**: PDFæ–‡ä»¶æ”¯æŒ
- **å„åè®®å®¢æˆ·ç«¯**: SMBã€FTPã€WebDAVã€NFSç­‰

### UIç»„ä»¶
- **Cached Network Image**: å›¾ç‰‡ç¼“å­˜
- **Photo View**: å›¾ç‰‡æŸ¥çœ‹å™¨
- **Staggered Grid View**: ç€‘å¸ƒæµå¸ƒå±€
- **Local Auth**: ç”Ÿç‰©è¯†åˆ«è®¤è¯

## ğŸ“ é¡¹ç›®ç»“æ„

```
lib/
â”œâ”€â”€ app/                           # åº”ç”¨é…ç½®
â”‚   â”œâ”€â”€ routes/                   # è·¯ç”±é…ç½®
â”‚   â””â”€â”€ themes/                   # ä¸»é¢˜é…ç½®
â”œâ”€â”€ core/                         # æ ¸å¿ƒåŠŸèƒ½
â”‚   â”œâ”€â”€ constants/               # å¸¸é‡å®šä¹‰
â”‚   â”œâ”€â”€ services/                # æ ¸å¿ƒæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ network/            # ç½‘ç»œåè®®å®ç°
â”‚   â”‚   â”œâ”€â”€ app_lifecycle_manager.dart
â”‚   â”‚   â”œâ”€â”€ privacy_service.dart
â”‚   â”‚   â””â”€â”€ task_tracker_service.dart
â”‚   â””â”€â”€ utils/                   # å·¥å…·ç±»
â”œâ”€â”€ data/                        # æ•°æ®å±‚
â”‚   â”œâ”€â”€ database/               # æ•°æ®åº“å®šä¹‰
â”‚   â”œâ”€â”€ models/                 # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ repositories/           # æ•°æ®ä»“åº“
â”‚   â””â”€â”€ services/               # æ•°æ®æœåŠ¡
â”‚       â”œâ”€â”€ drift_database_service.dart
â”‚       â”œâ”€â”€ library_service.dart
â”‚       â””â”€â”€ multi_device_sync_service.dart
â””â”€â”€ presentation/               # è¡¨ç°å±‚
    â”œâ”€â”€ pages/                  # é¡µé¢ç»„ä»¶
    â”‚   â”œâ”€â”€ bookshelf/         # ä¹¦æ¶é¡µé¢
    â”‚   â”œâ”€â”€ library/           # æ¼«ç”»åº“ç®¡ç†
    â”‚   â”œâ”€â”€ manga_detail/      # æ¼«ç”»è¯¦æƒ…
    â”‚   â”œâ”€â”€ reader/            # é˜…è¯»å™¨
    â”‚   â”œâ”€â”€ settings/          # è®¾ç½®é¡µé¢
    â”‚   â””â”€â”€ sync/              # åŒæ­¥é¡µé¢
    â”œâ”€â”€ providers/             # çŠ¶æ€ç®¡ç†
    â””â”€â”€ widgets/               # UIç»„ä»¶
        â”œâ”€â”€ library/           # æ¼«ç”»åº“ç»„ä»¶
        â”œâ”€â”€ manga/             # æ¼«ç”»ç»„ä»¶
        â”œâ”€â”€ privacy/           # éšç§ç»„ä»¶
        â””â”€â”€ reader/            # é˜…è¯»å™¨ç»„ä»¶
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Flutter SDK >= 3.10.0
- Dart SDK >= 3.0.0
- æ”¯æŒçš„å¹³å°ï¼šAndroidã€iOSã€Windowsã€macOSã€Linux

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd manhua
```

2. **å®‰è£…ä¾èµ–**
```bash
flutter pub get
```

3. **ä»£ç ç”Ÿæˆ**
```bash
dart run build_runner build --delete-conflicting-outputs
```

4. **è¿è¡Œåº”ç”¨**
```bash
# Android
flutter run -d android

# iOS
flutter run -d ios

# Windows
flutter run -d windows

# macOS
flutter run -d macos

# Linux
flutter run -d linux
```

## ğŸ“± ä¸»è¦é¡µé¢

### ğŸ  é¦–é¡µ (HomePage)
- æœ€è¿‘é˜…è¯»æ¼«ç”»
- å¿«é€Ÿè®¿é—®åŠŸèƒ½
- ç»Ÿè®¡ä¿¡æ¯å±•ç¤º

### ğŸ“š æ¼«ç”»åº“ (LibraryPage)
- æ¼«ç”»åº“åˆ›å»ºå’Œç®¡ç†
- ç½‘ç»œåè®®é…ç½®
- æ‰«æè¿›åº¦ç›‘æ§
- éšç§è®¾ç½®

### ğŸ“– ä¹¦æ¶ (BookshelfPage)
- ç»Ÿä¸€å±•ç¤ºæ‰€æœ‰æ¿€æ´»åº“çš„æ¼«ç”»
- å¤šç§å¸ƒå±€æ¨¡å¼ï¼ˆç½‘æ ¼ã€åˆ—è¡¨ï¼‰
- æ™ºèƒ½æœç´¢å’Œç­›é€‰
- æ’åºåŠŸèƒ½ï¼ˆåç§°ã€æœ€è¿‘é˜…è¯»ã€æ·»åŠ æ—¶é—´ï¼‰

### ğŸ” æœç´¢ (SearchPage)
- å…¨å±€æ¼«ç”»æœç´¢
- é«˜çº§ç­›é€‰é€‰é¡¹
- æœç´¢å†å²è®°å½•

### âš™ï¸ è®¾ç½® (SettingsPage)
- å¤–è§‚è®¾ç½®ï¼ˆä¸»é¢˜ã€è¯­è¨€ï¼‰
- é˜…è¯»å™¨è®¾ç½®
- éšç§è®¾ç½®
- å­˜å‚¨ç®¡ç†
- å…³äºä¿¡æ¯

### ğŸ“„ æ¼«ç”»è¯¦æƒ… (MangaDetailPage)
- æ¼«ç”»åŸºæœ¬ä¿¡æ¯
- é˜…è¯»è¿›åº¦æ˜¾ç¤º
- é¡µé¢é¢„è§ˆï¼ˆç€‘å¸ƒæµï¼‰
- æ”¶è—å’Œåˆ†äº«åŠŸèƒ½

### ğŸ“– é˜…è¯»å™¨ (ReaderPage)
- å…¨å±é˜…è¯»æ¨¡å¼
- åº•éƒ¨è¿›åº¦æ¡å’Œé¢„è§ˆ
- é˜…è¯»è®¾ç½®é¢æ¿
- å¿«æ·é”®æ”¯æŒ

### ğŸ”„ åŒæ­¥é¡µé¢ (SyncPage)
- è®¾å¤‡å‘ç°å’Œè¿æ¥
- æ¼«ç”»åº“åŒæ­¥ç®¡ç†
- åŒæ­¥è¿›åº¦ç›‘æ§

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½è¯¦è§£

### ç½‘ç»œåè®®æ”¯æŒ

é¡¹ç›®å®ç°äº†å®Œæ•´çš„ç½‘ç»œæ–‡ä»¶ç³»ç»ŸæŠ½è±¡å±‚ï¼Œæ”¯æŒå¤šç§åè®®ï¼š

```dart
// ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿå·¥å‚
NetworkFileSystem fileSystem = NetworkFileSystemFactory.create(config);
await fileSystem.connect();
List<NetworkFileInfo> files = await fileSystem.listDirectory('/');
```

æ”¯æŒçš„åè®®ï¼š
- **HTTP/HTTPS**: åŸºäºæ ‡å‡†HTTPåè®®çš„æ–‡ä»¶è®¿é—®
- **SMB/CIFS**: Windowsç½‘ç»œå…±äº«ï¼Œä½¿ç”¨`smb_connect`åŒ…
- **FTP/SFTP**: æ–‡ä»¶ä¼ è¾“åè®®ï¼Œæ”¯æŒåŠ å¯†ä¼ è¾“
- **WebDAV**: åŸºäºHTTPçš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ
- **NFS**: ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼Œæ”¯æŒLinux/macOSæŒ‚è½½

### éšç§ä¿æŠ¤æœºåˆ¶

```dart
// è®¾ç½®æ¼«ç”»åº“ä¸ºéšç§æ¨¡å¼
await PrivacyService.setLibraryPrivate(libraryId, true);

// éªŒè¯è®¿é—®æƒé™
bool hasAccess = await PrivacyService.verifyAccess(libraryId);
```

éšç§åŠŸèƒ½ç‰¹æ€§ï¼š
- æ¼«ç”»åº“çº§åˆ«çš„éšç§ä¿æŠ¤
- å¯†ç  + ç”Ÿç‰©è¯†åˆ«åŒé‡è®¤è¯
- åº”ç”¨åå°è‡ªåŠ¨æ¨¡ç³Šä¿æŠ¤
- é‡å¯åº”ç”¨éœ€é‡æ–°éªŒè¯

### å¤šè®¾å¤‡åŒæ­¥

```dart
// å‘ç°å±€åŸŸç½‘è®¾å¤‡
Stream<List<DeviceInfo>> devices = MultiDeviceSyncService.devicesStream;

// åŒæ­¥æ¼«ç”»åº“
await MultiDeviceSyncService.syncLibrary(libraryId, targetDeviceId);
```

åŒæ­¥åŠŸèƒ½ï¼š
- mDNS + UDPåŒé‡è®¾å¤‡å‘ç°
- æ¼«ç”»åº“å…ƒæ•°æ®åŒæ­¥
- é˜…è¯»è¿›åº¦åŒæ­¥
- å¢é‡åŒæ­¥æ”¯æŒ

## ğŸ—„ï¸ æ•°æ®æ¨¡å‹

### æ ¸å¿ƒæ¨¡å‹

```dart
// æ¼«ç”»æ¨¡å‹
class Manga {
  final String id;
  final String title;
  final String? author;
  final String? coverPath;
  final int totalPages;
  final ReadingProgress? progress;
  // ...
}

// æ¼«ç”»åº“æ¨¡å‹
class MangaLibrary {
  final String id;
  final String name;
  final String path;
  final NetworkConfig? networkConfig;
  final bool isPrivate;
  final CoverDisplayMode coverMode;
  // ...
}

// ç½‘ç»œé…ç½®æ¨¡å‹
class NetworkConfig {
  final NetworkProtocol protocol;
  final String host;
  final int port;
  final String? username;
  final String? password;
  // ...
}
```

## ğŸ”¨ å¼€å‘æŒ‡å—

### ä»£ç è§„èŒƒ
- éµå¾ª Dart å®˜æ–¹ä»£ç é£æ ¼
- ä½¿ç”¨ Riverpod è¿›è¡ŒçŠ¶æ€ç®¡ç†
- é‡‡ç”¨ Repository æ¨¡å¼ç®¡ç†æ•°æ®
- ä½¿ç”¨ Drift è¿›è¡Œæ•°æ®åº“æ“ä½œ

### æ¶æ„åŸåˆ™
- **åˆ†å±‚æ¶æ„**: è¡¨ç°å±‚ã€ä¸šåŠ¡å±‚ã€æ•°æ®å±‚æ¸…æ™°åˆ†ç¦»
- **ä¾èµ–æ³¨å…¥**: ä½¿ç”¨ Riverpod è¿›è¡Œä¾èµ–ç®¡ç†
- **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
- **æ—¥å¿—è®°å½•**: å®Œå–„çš„æ—¥å¿—ç³»ç»Ÿ

### æ·»åŠ æ–°çš„ç½‘ç»œåè®®

1. å®ç° `NetworkFileSystem` æ¥å£
2. åœ¨ `NetworkFileSystemFactory` ä¸­æ³¨å†Œ
3. æ·»åŠ åè®®æšä¸¾å€¼
4. å®ç°è¿æ¥æµ‹è¯•é€»è¾‘

```dart
class CustomFileSystem extends NetworkFileSystem {
  @override
  Future<void> connect() async {
    // å®ç°è¿æ¥é€»è¾‘
  }
  
  @override
  Future<List<NetworkFileInfo>> listDirectory([String path = '/']) async {
    // å®ç°ç›®å½•åˆ—è¡¨é€»è¾‘
  }
}
```

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•
```bash
# å•å…ƒæµ‹è¯•
flutter test

# é›†æˆæµ‹è¯•
flutter test integration_test/
```

### æµ‹è¯•è¦†ç›–
- æ ¸å¿ƒæœåŠ¡å•å…ƒæµ‹è¯•
- ç½‘ç»œåè®®é›†æˆæµ‹è¯•
- UIç»„ä»¶æµ‹è¯•
- éšç§åŠŸèƒ½æµ‹è¯•

## ğŸ“¦ æ„å»ºå‘å¸ƒ

### Android
```bash
flutter build apk --release
flutter build appbundle --release
```

### iOS
```bash
flutter build ios --release
```

### Desktop
```bash
# Windows
flutter build windows --release

# macOS
flutter build macos --release

# Linux
flutter build linux --release
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- Flutter å›¢é˜Ÿæä¾›çš„ä¼˜ç§€æ¡†æ¶
- æ‰€æœ‰å¼€æºåŒ…çš„è´¡çŒ®è€…
- ç¤¾åŒºçš„åé¦ˆå’Œå»ºè®®

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- æäº¤ Issue
- å‘èµ· Discussion
- é‚®ä»¶è”ç³»

---

**æ³¨æ„**: é¦–æ¬¡è¿è¡Œå¯èƒ½éœ€è¦ä¸‹è½½å­—ä½“æ–‡ä»¶å’Œåˆå§‹åŒ–æ•°æ®åº“ï¼ŒæŸäº›åŠŸèƒ½éœ€è¦ç›¸åº”çš„ç³»ç»Ÿæƒé™ã€‚